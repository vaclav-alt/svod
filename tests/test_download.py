from svod.download_svod import download_year_table
import unittest

sample_table = {
    'Rok': {0: 1978.0, 1: 1979.0, 2: 1980.0, 3: 1981.0, 4: 1982.0, 5: 1983.0, 6: 1984.0, 7: 1985.0, 8: 1986.0,
            9: 1987.0, 10: 1988.0, 11: 1989.0, 12: 1990.0, 13: 1991.0, 14: 1992.0, 15: 1993.0, 16: 1994.0, 17: 1995.0,
            18: 1996.0, 19: 1997.0, 20: 1998.0, 21: 1999.0, 22: 2000.0, 23: 2001.0, 24: 2002.0, 25: 2003.0, 26: 2004.0,
            27: 2005.0, 28: 2006.0, 29: 2007.0, 30: 2008.0, 31: 2009.0, 32: 2010.0, 33: 2011.0, 34: 2012.0, 35: 2013.0,
            36: 2014.0, 37: 2015.0, 38: 2016.0, 39: 2017.0},
    'Incidence': {0: 3.0, 1: 12.0, 2: 4.0, 3: 7.0, 4: 5.0, 5: 7.0, 6: 7.0, 7: 6.0, 8: 8.0, 9: 9.0, 10: 0.0, 11: 3.0,
                  12: 4.0, 13: 7.0, 14: 3.0, 15: 1.0, 16: 4.0, 17: 8.0, 18: 2.0, 19: 7.0, 20: 7.0, 21: 6.0, 22: 6.0,
                  23: 5.0, 24: 12.0, 25: 9.0, 26: 13.0, 27: 7.0, 28: 10.0, 29: 9.0, 30: 5.0, 31: 4.0, 32: 15.0, 33: 9.0,
                  34: 10.0, 35: 7.0, 36: 14.0, 37: 9.0, 38: 10.0, 39: 14.0},
    'Mortalita': {0: 0.0, 1: 2.0, 2: 1.0, 3: 3.0, 4: 4.0, 5: 4.0, 6: 8.0, 7: 4.0, 8: 3.0, 9: 0.0, 10: 6.0, 11: 2.0,
                  12: 1.0, 13: 2.0, 14: 1.0, 15: 4.0, 16: 3.0, 17: 1.0, 18: 4.0, 19: 10.0, 20: 2.0, 21: 3.0, 22: 2.0,
                  23: 3.0, 24: 3.0, 25: 2.0, 26: 4.0, 27: 6.0, 28: 5.0, 29: 3.0, 30: 1.0, 31: 0.0, 32: 1.0, 33: 3.0,
                  34: 5.0, 35: 3.0, 36: 2.0, 37: 4.0, 38: 1.0, 39: 3.0}}


class TestDownload(unittest.TestCase):
    def test_download(self):
        url = (
            "https://www.svod.cz/graph/?sessid=slr1opn84pssncqr5hekcj6d87"
            "&typ=incmor"
            "&zobrazeni=table"
            "&incidence=1"
            "&mortalita=1"
            "&mi=0"
            "&vypocet=a"
            "&lecba="
            "&pohl=m"
            "&zije="
            "&umrti="
            "&kraj="
            "&stadium="
            "&t="
            "&n="
            "&m="
            "&diag=C50"
            "&vek_do=15"
            "&vek_od=15"
            "&obdobi_od=1978"
            "&obdobi_do=2017"
        )
        table = download_year_table(url)
        self.assertDictEqual(table.to_dict(), sample_table)
